name: Docker Compose Actions Workflow

on: 
  push:
  workflow_dispatch:
    inputs:
      logLevel:
        description: 'Log level'     
        required: true
        default: 'warning'
      tags:
        description: 'Test scenario tags'  

jobs:
  test:

    runs-on: ubuntu-latest
      
    steps:
      - uses: actions/checkout@v2
      - name: Build the stack
        run: docker-compose up -d
      - name: Test customer api
        run: docker run --network container:customer.api appropriate/curl -s --retry 10 --retry-connrefused http://localhost:5100/
      - name: Test customer web
        run: docker run --network container:customer.web appropriate/curl -s --retry 10 --retry-connrefused http://localhost:6100/
